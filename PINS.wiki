== How to Write a Performance Instrumentation module ==

This page will explain how to use the Performance INStrumentation (PINS) system to instrument the operation of PaRSEC. It uses the existing "print_steals" module as an example of a bare-bones PINS module that does not require the use of the PaRSEC profiling system for the collection of its data, and does not use PAPI for hardware measurement purposes. For help with using PAPI and the profiling system in PaRSEC to perform low-impact hardware-provided event measurements, refer to the built-in "papi_exec" and "papi_select" modules once you understand the architecture of the PINS system.

PINS is implemented as an extension to the Modular Component Architecture, originally of OpenMPI. This provides very simple integration with the PaRSEC build process and PaRSEC runtime, at the cost of some extra 'markup' code in the *_component.c file for each module. You can use any MCA component or PINS module as a reference for how to write the code necessary for MCA to understand your PINS module.

A PINS module is generally comprised of two main pieces - the initialization and finalization code, and the callback functions that perform the instrumentation itself. There are 3 pairs of initialization and finalization functions - each invoked by a specific part of the runtime - and your module may implement as many or as few of them as are needed. They are:
* {{{pins_init}}}
* pins_fini
* pins_thread_init
* pins_thread_fini
* pins_handle_init
* pins_handle_fini
pins_init is invoked

